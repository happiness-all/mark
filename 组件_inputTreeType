<template>
    <div class="learnType" @click="btnRegion">
        <el-input type="text" class="regions-tree-search" :placeholder="'请选择课程类型'" readonly v-model="region"></el-input>
        <i class="el-icon-arrow-up arrow" v-show="showLearnType"></i>
        <i class="el-icon-arrow-down arrow" v-show="!showLearnType"></i>
        <div class="tree-box" v-show="showLearnType">
            <el-tree node-key="typeName" ref="trees" :data='learnTypeData' :props="defaultProps" @node-click="handleNodeClick" :current-node-key="defaultSubjectType"
                id='tree' class="input-tree"></el-tree>
        </div>
    </div>
</template>
<script>
    export default {
        data() {
            return {
                showLearnType: false,
                region: "",
                defaultProps: {
                    children: 'children',
                    label: 'typeName',
                    disabled: this.disabled
                }
            }
        },
        props: ['learnTypeData', 'defaultSubjectType','type'],
        created() {
            this.region = this.defaultSubjectType
            let regionParams = {}
            let regionParamsArray = []
            this.learnTypeData.forEach((list, index) => {
                // if (list.children) {
                    list.children.forEach((item, inx) => {
                        regionParamsArray.push(item)
                    })
                    regionParams = regionParamsArray.filter((item) => {
                        return item.typeName == this.defaultSubjectType;
                    });
                // }
            })
            this.handleNodeClick(regionParams[0])
        },
        methods: {
            handleNodeClick(data) {
                
                if (data&&data.children) {
                    if (data.children.length > 0&& this.type!='studyList') {
                        return;
                    }
                    this.region = data.typeName
                this.$emit("changeLearnType", data)
                this.showLearnType = false
                }
              
            },
            btnRegion() {
                this.showLearnType = !this.showLearnType
            },
           

        }
    }
</script>
<style lang="less" scoped>
    .learnType {
        position: relative;
        cursor: pointer;
        width: 100%;
        margin-left: 10px;
        /deep/.el-select__caret {
            position: absolute;
            right: 0;
            top: 8%
        }
        /deep/ .el-select-dropdown {
            width: 520px;
            .el-input {
                width: 100%;
            }
            .regions-search-icon {
                right: 30px;
            }
        }
        /deep/ .el-tree-node:focus>.el-tree-node__content {
            background-color: #e6feff !important;
            color: #00AAFF;

        }
        /deep/.el-tree-node__content {
            height: 32px;
        }
        /deep/.el-input__inner {
            cursor: pointer;
        }
        /deep/ .el-input {
            width: 100% !important;
        }
        .region-tag {
            margin-left: 12px;
        }
        .arrow {
            position: absolute;
            top: 50%;
            right: 12px;
            transform: translate(0, -50%);
            color: #C0C4CC
        }
        .input-tree {
            overflow-y: scroll;
        }
        .tree-box {
            position: absolute;
            top: 40px;
            width: 100%;
            border: 1px solid #DCDFE6;
            z-index: 10;
            background: #ffffff;
            overflow-y: scroll;
            max-height: 273px;
            min-height: 60px;
            .default-tag {
                color: #606266;
                border-bottom: 1px solid #DCDFE6;
                padding-left: 26px;
                height: 32px;
                line-height: 32px;
                margin-bottom: 8px;
            }
        }

    }

    .btn-wrap {
        padding-top: 10px;
        margin-right: 20px;
        margin-top: 10px;
        border-top: 1px solid #ddd;
        height: 20px;
        text-align: right;
    }

    .tree-default-btn,
    .tree-btn {
        background: #fff;
        border-radius: 2px;
        padding: 0;
        height: 20px;
        line-height: 20px;
        color: #00aaff;
        text-align: center;
        float: right;
        margin-left: 15px;
        border: none;
        box-sizing: border-box;
        cursor: pointer;
    }

    .tree-default-btn {
        background: #fff;
        color: #999999;
    }
</style>
